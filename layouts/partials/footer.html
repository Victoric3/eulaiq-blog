{{ partial "custom_footer.html" . }}

{{- /* Smooth scroll for anchor links */ -}}
<script>
document.querySelectorAll('a[href^="#"]').forEach(function(anchor) {
    anchor.addEventListener("click", function (e) {
        e.preventDefault();
        var id = this.getAttribute("href").substr(1);
        var el = document.querySelector("[id='" + decodeURIComponent(id) + "']");
        if (el) el.scrollIntoView({ behavior: "smooth" });
        if (id === "top") history.replaceState(null, null, " ");
        else history.pushState(null, null, "#" + id);
    });
});
</script>

{{- /* Code copy buttons on single posts */ -}}
{{- if (and (eq .Kind "page") (ne .Layout "archives") (ne .Layout "search") (.Param "ShowCodeCopyButtons")) }}
<script>
document.querySelectorAll('pre > code').forEach(function(codeblock) {
    var container = codeblock.parentNode.parentNode;
    var copybutton = document.createElement('button');
    copybutton.classList.add('copy-code');
    copybutton.innerHTML = '{{ i18n "code_copy" | default "copy" }}';
    function copyingDone() {
        copybutton.innerHTML = '{{ i18n "code_copied" | default "copied!" }}';
        setTimeout(function() {
            copybutton.innerHTML = '{{ i18n "code_copy" | default "copy" }}';
        }, 2000);
    }
    copybutton.addEventListener('click', function() {
        if ('clipboard' in navigator) {
            navigator.clipboard.writeText(codeblock.textContent);
            copyingDone();
            return;
        }
        var range = document.createRange();
        range.selectNodeContents(codeblock);
        var selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        try { document.execCommand('copy'); copyingDone(); } catch (e) {}
        selection.removeRange(range);
    });
    if (container.classList.contains("highlight")) {
        container.appendChild(copybutton);
    }
});
</script>
{{- end }}
